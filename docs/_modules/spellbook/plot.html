
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>spellbook.plot &#8212; spellbook</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tooltip.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script defer="defer" src="../../_static/tooltip.js"></script>
    <script src="../../_static/glossary.json"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../_static/spellbook-icon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/spellbook-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">spellbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search" aria-label="Search" autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The spellbook Library
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../API.html">
   Source Code Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../API-python.html">
     Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.input.html">
       spellbook.input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.inspect.html">
       spellbook.inspect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.plot.html">
       spellbook.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.plot1D.html">
       spellbook.plot1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.plot2D.html">
       spellbook.plot2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.plotutils.html">
       spellbook.plotutils
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.stat.html">
       spellbook.stat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_stubs/spellbook.train.html">
       spellbook.train
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tools.html">
   Tools and Technologies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/aws.html">
     AWS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/conda.html">
     Conda, Mamba &amp; Pip
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/docker.html">
     Docker
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/gcp.html">
     GCP
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tools/git.html">
     Git
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tools/github.html">
       GitHub
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/jupyter.html">
     Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/mkdocs.html">
     MkDocs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/pandas.html">
     pandas
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tools/python.html">
     Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tools/python-logging.html">
       Logging
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/rich.html">
     Rich
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/sphinx.html">
     Sphinx
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tools/tf.html">
     TensorFlow
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tools/tf-save.html">
       Saving and Loading Models
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/virtualenv.html">
     virtualenv &amp; venv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools/vscode.html">
     Visual Studio Code
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects &amp; Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../examples/examples.html">
   Table of Contents
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../examples/1-binary-stroke-prediction/index.html">
   Binary Classification: Stroke Prediction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../examples/1-binary-stroke-prediction/exploration-cleaning.html">
     Data Exploration and Cleaning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../examples/1-binary-stroke-prediction/input-pipeline.html">
     Data Preparation and Input Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../examples/1-binary-stroke-prediction/training-validation.html">
     Model Training and Validation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../examples/2-tensorflow-decision-forests/index.html">
   Decision Forests in TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../_examples/3-tensorflow-serving-docker/code.html">
   Serving
   <em>
    TensorFlow
   </em>
   Models in
   <em>
    Docker
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../examples/4-tf-serving-docker-aws/index.html">
   <em>
    TensorFlow Serving
   </em>
   with
   <em>
    Docker
   </em>
   on
   <em>
    AWS
   </em>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Extras
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../literature.html">
   Links &amp; Literature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../genindex.html">
   Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../todo.html">
   ToDo List
  </a>
 </li>
</ul>

    </div>
</nav><div class="navbar_extra_footer">
    <table style="margin-top:2.0rem;">
        <tr>
            <td style="text-align: left;">
                <a href="https://github.com/dmrauch">
                    <img src="../../_static/GitHub-Mark-32px.png" height="16" padding-right="1em">
                </a>
            </td>
            <td style="padding-left: 0.5rem; text-align: left; font-style:italic; font-weight: bold;">
                Contact me on <a href="https://github.com/dmrauch">GitHub</a>
            </td>
        </tr>
        <tr>
            <td style="text-align: left;">
                <a href="https://www.linkedin.com/in/dmrauch/">
                    <img src="../../_static/LI-In-Bug.png" height="16" padding-right="1em"></td>
                </a>
            <td style="padding-left: 0.5rem; text-align: left; font-style:italic; font-weight: bold;">
                Contact me on <a href="https://www.linkedin.com/in/dmrauch/">LinkedIn</a>
            </td>
        </tr>
    </table>
</div></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/dmrauch/spellbook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/dmrauch/spellbook/issues/new?title=Issue%20on%20page%20%2F_modules/spellbook/plot.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <h1>Source code for spellbook.plot</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">High-level functions for creating and saving plots</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">spellbook</span> <span class="k">as</span> <span class="nn">sb</span>



<span class="c1"># At some point all the plotting stuff can be organised into proper classes.</span>
<span class="c1"># The advantage would be that accessors to elements can be made available in a</span>
<span class="c1"># more organised way. Something like</span>
<span class="c1">#</span>
<span class="c1">#   fig = sb.plot.plot_grid_2D(nrows=2, ncols=5,</span>
<span class="c1">#                             data=data, xs=features, ys=target, relative=&#39;true&#39;)</span>
<span class="c1">#   sb.plot2D.heatmap_set_annotations_fontsize(ax=fig.get_axes()[7],</span>
<span class="c1">#                                             fontsize=&#39;x-small&#39;)</span>
<span class="c1">#</span>
<span class="c1"># would not be necessary anymore and could be replaced with the likes of</span>
<span class="c1">#</span>
<span class="c1">#   corrs = sb.plot.grid_2D(nrows=2, ncols=5,</span>
<span class="c1">#                          data=data, xs=features, ys=target, relative=&#39;true&#39;)</span>
<span class="c1">#   corrs.plots[iRow][iCol].set_annotation_fontsize(&#39;x-small&#39;)</span>
<span class="c1">#</span>
<span class="c1"># class PlotBase:</span>
<span class="c1">#     # - fig</span>
<span class="c1">#     # - ax</span>
<span class="c1">#     # - save()</span>
<span class="c1">#     pass</span>
<span class="c1">#</span>
<span class="c1"># class Plot(PlotBase):</span>
<span class="c1">#     # - grid(1,1)</span>
<span class="c1">#     # - plot: instance of type Barchart, Histogram, Heatmap, ...</span>
<span class="c1">#     pass</span>
<span class="c1">#</span>
<span class="c1"># class PlotGrid(PlotBase):</span>
<span class="c1">#     # - grid(n,m)</span>
<span class="c1">#     # - axs: [[...], [...]] nested list so that each of them can be accessed</span>
<span class="c1">#     # - plots: [[...], [...]] nested list of types Barchart, Histogram, ...</span>
<span class="c1">#     pass</span>



<div class="viewcode-block" id="save"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.save">[docs]</a><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span>
         <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Save a plot to a file</span>

<span class="sd">    Args:</span>
<span class="sd">        fig: The figure to plot</span>
<span class="sd">        filename: The filename under which to save the plot</span>
<span class="sd">        dpi: Optional resolution</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved plot to file &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span></div>



<div class="viewcode-block" id="plot_1D"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.plot_1D">[docs]</a><span class="k">def</span> <span class="nf">plot_1D</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">,</span>
            <span class="n">figure_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">barchart_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">histogram_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">histplot_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">statsbox_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create a single univariate plot</span>

<span class="sd">    The type of the variable (*categorical* or *continuous*) is determined</span>
<span class="sd">    automatically and either :func:`spellbook.plot1D.barchart` or</span>
<span class="sd">    :func:`spellbook.plot1D.histogram` is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (:class:`pandas.DataFrame`): The dataset to plot</span>
<span class="sd">        x: Name of the variable to plot</span>
<span class="sd">        xlabel: *Optional*. Title of the x-axis. If unspecified or set to</span>
<span class="sd">            ``None``, the name of the variable, as specified by **x**, will</span>
<span class="sd">            be used.</span>
<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements. This is</span>
<span class="sd">            probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        figure_args: *Optional*. Arguments for the creation of the</span>
<span class="sd">            :class:`matplotlib.figure.Figure` with</span>
<span class="sd">            :func:`matplotlib.pyplot.figure`</span>
<span class="sd">        barchart_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot1D.barchart` for categorical data</span>
<span class="sd">        histogram_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot1D.histogram` for continuous data</span>
<span class="sd">        histplot_args: *Optional*. Arguments for :func:`seaborn.histplot`,</span>
<span class="sd">            which is used to draw the plot</span>
<span class="sd">        statsbox_args: *Optional*. Arguments passed on by</span>
<span class="sd">            `spellbook.plot1D.histogram` to :func:`spellbook.plotutils.statsbox`</span>

<span class="sd">    Returns:</span>
<span class="sd">        The figure containing the plot</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">figure_args</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">plot1D</span><span class="o">.</span><span class="n">barchart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
                          <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">,</span>
                          <span class="o">**</span><span class="n">barchart_args</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;ord&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plot1D/ord: TODO / IMPLEMENTATION MISSING&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">plot1D</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                           <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
                           <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">,</span>
                           <span class="n">statsbox_args</span><span class="o">=</span><span class="n">statsbox_args</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">histogram_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>



<div class="viewcode-block" id="plot_grid_1D"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.plot_grid_1D">[docs]</a><span class="k">def</span> <span class="nf">plot_grid_1D</span><span class="p">(</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                 <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">features</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">xlabels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">,</span>
                 <span class="n">figure_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
                 <span class="n">stats</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">stats_align</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">binwidths</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">histogram_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create a grid of univariate plots</span>

<span class="sd">    The type / visual representation of each variable is determined automatically</span>
<span class="sd">    via :func:`spellbook.plotutils.get_data_kind`. Categorical variables are shown as</span>
<span class="sd">    barcharts and continuous variables are shown as univariate / 1D histograms.</span>
<span class="sd">    Summary statistics boxes can be shown for the histograms.</span>

<span class="sd">    .. image:: ../images/plot_grid_1D.png</span>
<span class="sd">       :width: 800px</span>
<span class="sd">       :align: center</span>

<span class="sd">    Args:</span>
<span class="sd">        nrows: Number of rows</span>
<span class="sd">        ncols: Number of columns</span>
<span class="sd">        data (:class:`pandas.DataFrame`): The dataset to plot</span>
<span class="sd">        target: *Optional*. The name of the target variable. If specified,</span>
<span class="sd">            the target variable will be plotted first and highlighted by</span>
<span class="sd">            plotting it in orange. Either **target** or **features** has to</span>
<span class="sd">            be specified.</span>
<span class="sd">        features: *Optional*. List with the names of the feature</span>
<span class="sd">            variables. If specified, the feature variables will be plotted after</span>
<span class="sd">            the target variable. Either **target** or **features** has to</span>
<span class="sd">            be specified.</span>
<span class="sd">        xlabels: *Optional*. The titles of the x-axes. If unspecified or set to</span>
<span class="sd">            ``None``, the names of the variables, as specified by **target**</span>
<span class="sd">            and **features** will be used.</span>
<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements. This is</span>
<span class="sd">            probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        figure_args: *Optional*. Arguments for the creation of the returned</span>
<span class="sd">            :class:`matplotlib.figure.Figure` with</span>
<span class="sd">            :func:`matplotlib.pyplot.figure`</span>
<span class="sd">        stats: *Optional*. Bool or list of bools that</span>
<span class="sd">            indicate if statistics boxes are shown in each plot</span>
<span class="sd">        stats_align: *Optional*. List of alignment strings, one for</span>
<span class="sd">            each plot</span>
<span class="sd">        binwidths: *Optional*. Float or list of floats</span>
<span class="sd">            that indicate the binwidth in each plot</span>
<span class="sd">        histogram_args: *Optional*. Dictionary of parameters and values</span>
<span class="sd">            that are passed to :func:`spellbook.plot1D.histogram`</span>

<span class="sd">    Returns:</span>
<span class="sd">        Figure containing the grid of plots</span>
<span class="sd">    </span>
<span class="sd">    Example:</span>

<span class="sd">        .. code:: python</span>

<span class="sd">            import pandas as pd</span>
<span class="sd">            import spellbook as sb</span>
<span class="sd">            data = pd.read_csv(&#39;dataset.csv&#39;)</span>
<span class="sd">            plot_vars = sb.plot.plot_grid_1D(2, 4, data,</span>
<span class="sd">                target=&#39;z&#39;, features=[&#39;x&#39;, &#39;y&#39;],</span>
<span class="sd">                stats=True, stats_align=[&#39;tl&#39;, &#39;br&#39;, &#39;tr&#39;])</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="nb">vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">target</span><span class="p">:</span> <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">features</span><span class="p">:</span> <span class="nb">vars</span> <span class="o">+=</span> <span class="n">features</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">xlabels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">xlabels</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">binwidths</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">binwidths</span> <span class="o">=</span> <span class="p">[</span><span class="n">binwidths</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="o">**</span><span class="n">figure_args</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">irows</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">icols</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>

            <span class="n">i</span> <span class="o">=</span> <span class="n">irows</span><span class="o">*</span><span class="n">ncols</span> <span class="o">+</span> <span class="n">icols</span> <span class="c1"># vars index</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">):</span>
                <span class="c1"># ax = plt.Subplot(fig, grid[i])</span>
                <span class="c1"># ax.axis(&quot;off&quot;) # blank grid cell, without axes</span>
                <span class="k">continue</span>

            <span class="n">binwidth</span> <span class="o">=</span> <span class="n">binwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">binwidths</span><span class="p">)</span><span class="o">&gt;</span><span class="n">i</span> <span class="k">else</span> <span class="kc">None</span>
      
            <span class="c1"># statistics box</span>
            <span class="n">stat</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span><span class="o">&gt;</span><span class="n">i</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">stat</span><span class="p">:</span>
                <span class="n">stats_alignment</span> <span class="o">=</span> <span class="n">stats_align</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> \
                            <span class="k">if</span> <span class="p">(</span><span class="n">stats_align</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">stats_align</span><span class="p">)</span><span class="o">&gt;</span><span class="n">i</span><span class="p">)</span> \
                            <span class="k">else</span> <span class="s2">&quot;tr&quot;</span>

            <span class="n">histplot_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;binwidth&#39;</span><span class="p">:</span> <span class="n">binwidth</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">target</span> <span class="ow">and</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">histplot_args</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;C1&#39;</span>

            <span class="c1"># categorical variable</span>
            <span class="k">if</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot1D</span><span class="o">.</span><span class="n">barchart</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                  <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                  <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                  <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">)</span>

            <span class="c1"># ordinal variable</span>
            <span class="k">elif</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">==</span> <span class="s1">&#39;ord&#39;</span><span class="p">:</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">not_yet_implemented</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span>
                    <span class="s1">&#39;plot.plot_grid_1D() / ord&#39;</span><span class="p">)</span>
                <span class="c1"># plot = sns.histplot(data=data, x=vars[i], ax=axes[irows][icols], binwidth=binwidth)</span>

                <span class="c1"># # statistics box</span>
                <span class="c1"># if stat:</span>
                <span class="c1">#   sb.plotutils.statsbox(ax=axes[irows][icols],</span>
                <span class="c1">#           text=data[vars[i]].describe(percentiles=[]).round(2).to_string(),</span>
                <span class="c1">#           alignment=stats_alignment)</span>

            <span class="c1"># continuous variable</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">statsbox_args</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">stat</span><span class="p">:</span> <span class="n">statsbox_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alignment&#39;</span><span class="p">:</span> <span class="n">stats_alignment</span><span class="p">}</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot1D</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                   <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                   <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                   <span class="n">show_stats</span><span class="o">=</span><span class="n">stat</span><span class="p">,</span>
                                   <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">,</span>
                                   <span class="n">statsbox_args</span><span class="o">=</span><span class="n">statsbox_args</span><span class="p">,</span>
                                   <span class="o">**</span><span class="n">histogram_args</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>



<div class="viewcode-block" id="plot_2D"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.plot_2D">[docs]</a><span class="k">def</span> <span class="nf">plot_2D</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">,</span>
            <span class="n">figure_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">heatmap_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">violinplot_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">cathist_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">scatterplot_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create a single bivariate/correlation plot</span>

<span class="sd">    The types of the variables (*categorical* or *continuous*) are determined</span>
<span class="sd">    automatically and the corresponding 2D plotting function is called:</span>

<span class="sd">    - *x* is ``categorical`` and *y* is ``categorical``:</span>
<span class="sd">      :func:`spellbook.plot2D.heatmap`</span>
<span class="sd">    - *x* is ``categorical`` and *y* is ``continuous``:</span>
<span class="sd">      :func:`spellbook.plot2D.violinplot`</span>
<span class="sd">    - *x* is ``continuous`` and *y* is ``categorical``:</span>
<span class="sd">      :func:`spellbook.plot2D.categorical_histogram`</span>
<span class="sd">    - *x* is ``continuous`` and *y* is ``continuous``:</span>
<span class="sd">      :func:`spellbook.plot2D.scatterplot`</span>

<span class="sd">    Args:</span>
<span class="sd">        data (:class:`pandas.DataFrame`): The dataset to plot</span>
<span class="sd">        x: Name of the variable to plot on the x-axis</span>
<span class="sd">        y: Name of the variable to plot on the y-axis</span>
<span class="sd">        relative: Optional, whether or not the heatmaps drawn with</span>
<span class="sd">            :func:`spellbook.plot2D.heatmap` should be normalised or not</span>

<span class="sd">            - ``True``: heatmap will be column-normalised</span>
<span class="sd">              (``normalisation = norm-col``)</span>
<span class="sd">            - ``False``: heatmap will be show absolute numbers</span>
<span class="sd">              (``normalisation = count``)</span>

<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements.</span>
<span class="sd">            This is probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        figure_args: *Optional*. Arguments for the creation of the</span>
<span class="sd">            :class:`matplotlib.figure.Figure` with</span>
<span class="sd">            :func:`matplotlib.pyplot.figure`</span>
<span class="sd">        heatmap_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.heatmap` for correlations between</span>
<span class="sd">            a *categorical* variable on the x-axis and</span>
<span class="sd">            a *categorical* variable on the y-axis</span>
<span class="sd">        violinplot_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.violinplot` for correlations between</span>
<span class="sd">            a *categorical* variable on the x-axis and</span>
<span class="sd">            a *continuous* variable on the y-axis</span>
<span class="sd">        cathist_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.categorical_histogram` for correlations</span>
<span class="sd">            between</span>
<span class="sd">            a *continuous* variable on the x-axis and</span>
<span class="sd">            a *categorical* variable on the y-axis</span>
<span class="sd">        scatterplot_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.scatterplot` for correlations between</span>
<span class="sd">            a *continuous* variable on the x-axis and</span>
<span class="sd">            a *continuous* variable on the y-axis</span>

<span class="sd">    Returns:</span>
<span class="sd">        The figure containing the plot</span>

<span class="sd">    Examples:</span>

<span class="sd">    - simple example</span>

<span class="sd">      .. code:: python</span>

<span class="sd">         fig = sb.plot.plot_2D(data=data, x=&#39;age&#39;, y=target, fontsize=14.0)</span>

<span class="sd">    - advanced example</span>

<span class="sd">      The target variable has two categories and therefore, two histograms</span>
<span class="sd">      will be stacked on top of each other. Via the *histogram_args* parameter,</span>
<span class="sd">      a list of two dictionaries is passed on to</span>
<span class="sd">      :func:`spellbook.plot2D.categorical_histogram` - one dictionary for each</span>
<span class="sd">      of the two categories. Each one of the dictionaries is then passed on to</span>
<span class="sd">      :func:`spellbook.plot1D.histogram`.</span>

<span class="sd">      .. code:: python</span>
<span class="sd">  </span>
<span class="sd">          fig = sb.plot.plot_2D(</span>
<span class="sd">                    data=data, x=&#39;age&#39;, y=target, fontsize=11.0,</span>
<span class="sd">                    cathist_args = {</span>
<span class="sd">                        &#39;histogram_args&#39;: [</span>
<span class="sd">                            dict(</span>
<span class="sd">                                show_stats=True,</span>
<span class="sd">                                statsbox_args = {&#39;alignment&#39;: &#39;bl&#39;}</span>
<span class="sd">                            ),</span>
<span class="sd">                            dict(</span>
<span class="sd">                                show_stats=True,</span>
<span class="sd">                                statsbox_args = {</span>
<span class="sd">                                    &#39;y&#39;: 0.96,</span>
<span class="sd">                                    &#39;text_args&#39;: {</span>
<span class="sd">                                        # RGBA white with 50% alpha/opacity</span>
<span class="sd">                                        &#39;backgroundcolor&#39;: (1.0, 1.0, 1.0, 0.5)</span>
<span class="sd">                                    }</span>
<span class="sd">                                }</span>
<span class="sd">                            )</span>
<span class="sd">                        ]</span>
<span class="sd">                    })</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">figure_args</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">x_kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="n">y_kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
        <span class="n">normalisation</span> <span class="o">=</span> <span class="s1">&#39;norm-col&#39;</span> <span class="k">if</span> <span class="n">relative</span> <span class="k">else</span> <span class="s1">&#39;count&#39;</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                         <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">normalisation</span><span class="o">=</span><span class="n">normalisation</span><span class="p">,</span> <span class="o">**</span><span class="n">heatmap_args</span><span class="p">)</span>
    
    <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">violinplot_args</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">categorical_histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                       <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="o">**</span><span class="n">cathist_args</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">scatterplot_args</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>



<div class="viewcode-block" id="plot_grid_2D"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.plot_grid_2D">[docs]</a><span class="k">def</span> <span class="nf">plot_grid_2D</span><span class="p">(</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                 <span class="n">xs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">ys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">,</span>
                 <span class="n">figure_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
                 <span class="n">heatmap_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
                 <span class="n">violinplot_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
                 <span class="n">cathist_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
                 <span class="n">scatterplot_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create a grid of bivariate/correlation plots</span>

<span class="sd">    Args:</span>
<span class="sd">        nrows: Number of rows</span>
<span class="sd">        ncols: Number of columns</span>
<span class="sd">        data (:class:`pandas.DataFrame`): The dataset to plot</span>
<span class="sd">        xs: Names of the variables to plot on the x-axis</span>
<span class="sd">        ys: Names of the variables to plot on the y-axis</span>
<span class="sd">        relative: *Optional*. Whether or not the heatmaps drawn with</span>
<span class="sd">            :func:`spellbook.plot2D.heatmap` should be normalised or not</span>

<span class="sd">            - ``True``: heatmap will be column-normalised</span>
<span class="sd">              (``normalisation = norm-col``)</span>
<span class="sd">            - ``False``: heatmap will be show absolute numbers</span>
<span class="sd">              (``normalisation = count``)</span>

<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements.</span>
<span class="sd">            This is probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        figure_args: *Optional*. Arguments for the creation of the</span>
<span class="sd">            :class:`matplotlib.figure.Figure` with</span>
<span class="sd">            :func:`matplotlib.pyplot.figure`</span>
<span class="sd">        heatmap_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.heatmap` for correlations between</span>
<span class="sd">            a *categorical* variable on the x-axis and</span>
<span class="sd">            a *categorical* variable on the y-axis</span>
<span class="sd">        violinplot_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.violinplot` for correlations between</span>
<span class="sd">            a *categorical* variable on the x-axis and</span>
<span class="sd">            a *continuous* variable on the y-axis</span>
<span class="sd">        cathist_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.categorical_histogram` for correlations</span>
<span class="sd">            between</span>
<span class="sd">            a *continuous* variable on the x-axis and</span>
<span class="sd">            a *categorical* variable on the y-axis</span>
<span class="sd">        scatterplot_args: *Optional*. Arguments passed on to</span>
<span class="sd">            :func:`spellbook.plot2D.scatterplot` for correlations between</span>
<span class="sd">            a *continuous* variable on the x-axis and</span>
<span class="sd">            a *continuous* variable on the y-axis</span>

<span class="sd">    Returns:</span>
<span class="sd">        The figure containing the grid of plot</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">ys</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">))]</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">))</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">nrows</span> <span class="o">*</span> <span class="n">ncols</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">figure_args</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">irows</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">icols</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>

            <span class="n">i</span> <span class="o">=</span> <span class="n">irows</span><span class="o">*</span><span class="n">ncols</span> <span class="o">+</span> <span class="n">icols</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">x_kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">y_kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

            <span class="k">if</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
                <span class="n">normalisation</span> <span class="o">=</span> <span class="s1">&#39;norm-col&#39;</span> <span class="k">if</span> <span class="n">relative</span> <span class="k">else</span> <span class="s1">&#39;count&#39;</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                 <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                 <span class="n">normalisation</span><span class="o">=</span><span class="n">normalisation</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">heatmap_args</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                    <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">violinplot_args</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">categorical_histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                               <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                               <span class="o">**</span><span class="n">cathist_args</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                      <span class="o">**</span><span class="n">scatterplot_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>


<div class="viewcode-block" id="pairplot"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.pairplot">[docs]</a><span class="k">def</span> <span class="nf">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
             <span class="n">xs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
             <span class="n">ys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">,</span>
             <span class="n">histplot_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create a pairplot</span>

<span class="sd">    .. image:: ../images/pairplot-3x5.png</span>
<span class="sd">       :width: 700px</span>
<span class="sd">       :align: center</span>

<span class="sd">    The plot does not need to contain the same variables or number of variables</span>
<span class="sd">    in x and y. It can be rectangular with any number of rows and any number of</span>
<span class="sd">    columns. The subplots with the same variable in x and y are detected</span>
<span class="sd">    automatically, no matter where they are located in the pairplot, and instead</span>
<span class="sd">    of a 2D/bivariate/correlation plot, the appropriate 1D/univariate</span>
<span class="sd">    distribution is shown. This behaviour allows to split a full and possibly</span>
<span class="sd">    large pairplot for all variables into arbitrarily-sized separate smaller</span>
<span class="sd">    pieces.</span>

<span class="sd">    The visual representation of the distributions and correlations is chosen</span>
<span class="sd">    automatically depending on the type of random variables (categorical,</span>
<span class="sd">    ordinal, continuous).</span>

<span class="sd">    Args:</span>
<span class="sd">        data (:class:`pandas.DataFrame`): The dataset to plot</span>
<span class="sd">        xs: Names of the variables to plot on the x-axis</span>
<span class="sd">        ys: *Optional*. Names of the variables to plot on the y-axes.</span>
<span class="sd">            If not specified, the same variables will be shown on the x-axes</span>
<span class="sd">            and the y-axes.</span>
<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements.</span>
<span class="sd">            This is probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        histplot_args: *Optional*. Arguments for :func:`seaborn.histplot`,</span>
<span class="sd">            which is used to draw the histograms</span>

<span class="sd">    Returns:</span>
<span class="sd">        The figure containing the grid of plots</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">ys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">xs</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">)</span>

    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">iy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>

            <span class="n">i</span> <span class="o">=</span> <span class="n">iy</span><span class="o">*</span><span class="n">ncols</span> <span class="o">+</span> <span class="n">ix</span>
            <span class="n">x_kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">]])</span>
            <span class="n">y_kind</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">get_data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">ys</span><span class="p">[</span><span class="n">iy</span><span class="p">]])</span>
            <span class="n">histplot_args</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">==</span> <span class="n">ys</span><span class="p">[</span><span class="n">iy</span><span class="p">]:</span> <span class="c1"># on-diagonal: univariate plots</span>

                <span class="n">histplot_args</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;C1&#39;</span> <span class="c1"># &#39;gray&#39; # pink</span>

                <span class="k">if</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plot1D</span><span class="o">.</span><span class="n">barchart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span>
                                      <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                      <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;ord&#39;</span><span class="p">:</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plotutils</span><span class="o">.</span><span class="n">not_yet_implemented</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span>
                        <span class="s1">&#39;plot.pairplot()</span><span class="se">\n</span><span class="s1">on-diagonal / ord&#39;</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plot1D</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span>
                                       <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                       <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="kc">False</span> <span class="c1"># ax.axis(&quot;off&quot;)</span>

            <span class="k">else</span><span class="p">:</span> <span class="c1"># off-diagonal: bivariate/correlation plots</span>

                <span class="k">if</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">iy</span><span class="p">],</span>
                                     <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                     <span class="n">normalisation</span><span class="o">=</span><span class="s1">&#39;norm-col&#39;</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">iy</span><span class="p">],</span>
                                        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">categorical_histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">iy</span><span class="p">],</span>
                                                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">gridindex</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                                <span class="n">histplot_args</span><span class="o">=</span><span class="n">histplot_args</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">x_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span> <span class="ow">and</span> <span class="n">y_kind</span> <span class="o">==</span> <span class="s1">&#39;cont&#39;</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="n">iy</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                         <span class="n">show_lineplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>



<div class="viewcode-block" id="plot_confusion_matrix"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.plot_confusion_matrix">[docs]</a><span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                          <span class="n">class_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                          <span class="n">class_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">normalisation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
                          <span class="n">crop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">figsize</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">),</span>
                          <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">fontsize_annotations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                          <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create a confusion matrix heatmap plot</span>

<span class="sd">    .. image:: ../images/confusion-matrix-absolute.png</span>
<span class="sd">       :width: 600px</span>
<span class="sd">       :align: center</span>

<span class="sd">    Both the absolute frequencies as well as the relative frequencies, either</span>
<span class="sd">    normalised by the true labels, the predictedlabels or their combinations,</span>
<span class="sd">    can be shown. The desired behaviour is specified with the parameter</span>
<span class="sd">    ``normalisation``.</span>

<span class="sd">    Args:</span>
<span class="sd">        confusion_matrix (:class:`tf.Tensor`): The confusion</span>
<span class="sd">            matrix</span>
<span class="sd">        class_names: List of the class names</span>
<span class="sd">        class_ids: Optional, list of IDs for each target class.</span>
<span class="sd">            These IDs are shown on the x-axis and, together with the class</span>
<span class="sd">            names, on the y-axis.</span>
<span class="sd">        normalisation: Optional, indicates if the absolute or relative</span>
<span class="sd">            frequencies should be plotted</span>
<span class="sd">            </span>
<span class="sd">            - ``count``: Numbers of datapoints</span>
<span class="sd">            - ``norm-all``: Percentages normalised across all combinations of</span>
<span class="sd">              the true and the predicted classes/labels</span>
<span class="sd">            - ``norm-true``: Percentages normalised across the true labels</span>
<span class="sd">            - ``norm-pred``: Percentages normalised across the predicted classes</span>

<span class="sd">        figsize: Optional, size (width, height) of the figure in inches</span>
<span class="sd">        crop: Plots with *normalisation* set to ``norm-true``/``norm-pred``</span>
<span class="sd">            do not include the *SUM* row/column, respectively. When *crop* is</span>
<span class="sd">            set to</span>
<span class="sd">            </span>
<span class="sd">            - ``True``, the excluded *SUM* row/column is removed from the</span>
<span class="sd">              heatmap matrix, thus making it occupy a larger portion of the plot</span>
<span class="sd">            - ``False``, the excluded *SUM* row/column is kept empty but still</span>
<span class="sd">              included in the heatmap matrix, so as to make each cell appear</span>
<span class="sd">              in the same position as with normalisation set to ``count`` or</span>
<span class="sd">              ``norm-all``</span>

<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements.</span>
<span class="sd">            This is probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        fontsize_annotations: *Optional*. Fontsize for the annotations.</span>
<span class="sd">            As specified in :meth:`matplotlib.text.Text.set_fontsize`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The figure containing the plot</span>
<span class="sd">    </span>
<span class="sd">    See also:</span>
<span class="sd">        :func:`tf.math.confusion_matrix`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
                     <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;predicted labels&#39;</span><span class="p">,</span>
                     <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;true labels&#39;</span><span class="p">,</span>
                     <span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span>
                     <span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">,</span>
                     <span class="n">gridindex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="n">normalisation</span> <span class="o">=</span> <span class="n">normalisation</span><span class="p">,</span>
                     <span class="n">crop</span> <span class="o">=</span> <span class="n">crop</span><span class="p">,</span>
                     <span class="n">xlabels</span> <span class="o">=</span> <span class="n">class_ids</span><span class="p">,</span>
                     <span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                         <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">class_ids</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)],</span>
                     <span class="n">ylabels_horizontal</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                     <span class="n">heatmap_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">fontsize_annotations</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
                <span class="n">sb</span><span class="o">.</span><span class="n">plot2D</span><span class="o">.</span><span class="n">heatmap_set_annotations_fontsize</span><span class="p">(</span>
                    <span class="n">child</span><span class="p">,</span> <span class="n">fontsize_annotations</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>



<div class="viewcode-block" id="parallel_coordinates"><a class="viewcode-back" href="../../_stubs/spellbook.plot.html#spellbook.plot.parallel_coordinates">[docs]</a><span class="k">def</span> <span class="nf">parallel_coordinates</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">features</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">categories</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shift</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parallel coordinates plot</span>

<span class="sd">    .. image:: /images/parallel-coordinates.png</span>
<span class="sd">       :align: center</span>
<span class="sd">       :height: 250px</span>

<span class="sd">    Based on `Parallel Coordinates in Matplotlib</span>
<span class="sd">    &lt;https://benalexkeen.com/parallel-coordinates-in-matplotlib/&gt;`_,</span>
<span class="sd">    but extended to also support categorical variables.</span>

<span class="sd">    For categorical variables, a random uniform shift is applied to spread</span>
<span class="sd">    the lines in the vicinity of the respective classes. This way, there</span>
<span class="sd">    is an indication for the composition of the datapoints in a particular</span>
<span class="sd">    class/category in terms of the target labels/classes. Furthermore, the</span>
<span class="sd">    shift interval is sized according to the number of datapoints in the</span>
<span class="sd">    respective class/category in order to give an impression for how many</span>
<span class="sd">    datapoints there are in that class.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (:class:`pandas.DataFrame`): The dataset to plot</span>
<span class="sd">        features: The names of the feature variables</span>
<span class="sd">        target: The name of the target variable</span>
<span class="sd">        categories: Dictionary holding the category codes/indices and names</span>
<span class="sd">            as returned by :func:`spellbook.input.encode_categories`</span>
<span class="sd">        fontsize: *Optional*. Baseline fontsize for all elements.</span>
<span class="sd">            This is probably the fontsize that ``medium`` corresponds to?</span>
<span class="sd">        shift: *Optional*. The half-size of the interval for uniformely</span>
<span class="sd">            shifting categorical variables</span>

<span class="sd">    .. todo:: Support more than the 10 colours included in *Matplotlib*&#39;s</span>
<span class="sd">              tableau colours</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># get local copy to protect original data</span>

    <span class="n">target_name</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_codes&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="c1"># </span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_codes&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">features</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">)]</span>

    <span class="c1"># https://matplotlib.org/stable/gallery/color/named_colors.html</span>
    <span class="n">colours</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">TABLEAU_COLORS</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span>
        <span class="n">tmp_fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">cat_mins</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cat_maxs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
        <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_y&#39;</span>
        <span class="k">if</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="n">ncats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>

            <span class="c1"># counts / absolute frequencies of each class</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

            <span class="c1"># empty shifting vector, one entry per row/datapoint</span>
            <span class="n">shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]))</span>

            <span class="c1"># calculate shift for each class</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

                <span class="c1"># larger shift if class is more frequent</span>
                <span class="c1"># -&gt; thickness of line bundle indicates how many datapoints</span>
                <span class="c1">#    fall in that particular class</span>
                <span class="n">shifts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">*</span> <span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># apply uniform shifts</span>
            <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">ncats</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> \
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">-</span><span class="n">shifts</span><span class="p">,</span>
                                    <span class="n">high</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">+</span><span class="n">shifts</span><span class="p">)</span>
            <span class="n">cat_mins</span><span class="p">[</span><span class="n">feature</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">shift</span><span class="o">/</span><span class="p">(</span><span class="n">ncats</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">cat_maxs</span><span class="p">[</span><span class="n">feature</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ncats</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ncats</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
    <span class="n">cat_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cat_mins</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">cat_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cat_maxs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="c1"># Get min, max and range for each column</span>
    <span class="c1"># Normalize the data for each column</span>
    <span class="n">min_max_range</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
        <span class="n">min_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">max_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">val_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
        <span class="n">min_max_range</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">val_range</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">-</span><span class="n">cat_mins</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">cat_maxs</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">-</span><span class="n">cat_mins</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_val</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">cat_max</span><span class="o">-</span><span class="n">cat_min</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span>

    <span class="c1"># Plot each row</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">category</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">features</span><span class="p">],</span> <span class="n">colours</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Set the tick positions and labels on y axis for each plot</span>
    <span class="c1"># Tick positions based on normalised data</span>
    <span class="c1"># Tick labels are based on original data</span>
    <span class="k">def</span> <span class="nf">set_ticks_for_axis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">val_range</span> <span class="o">=</span> <span class="n">min_max_range</span><span class="p">[</span><span class="n">features</span><span class="p">[</span><span class="n">dim</span><span class="p">]]</span>

        <span class="n">feature</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="n">ncats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="p">[(</span><span class="n">cat_index</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ncats</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">shift</span><span class="p">)</span> 
                <span class="k">for</span> <span class="n">cat_index</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_val</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">step</span> <span class="o">=</span> <span class="n">max_val</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticks</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">norm_step</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticks</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">tick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">step</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ticks</span><span class="p">)]</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">norm_step</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ticks</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">step</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticks</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">norm_step</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticks</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">tick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">step</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ticks</span><span class="p">)]</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">norm_step</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ticks</span><span class="p">)]</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">cat_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">cat_max</span><span class="o">-</span><span class="n">cat_min</span><span class="p">)</span><span class="o">*</span><span class="n">tick</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">,</span> <span class="n">backgroundcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span> <span class="c1"># fontweight=&#39;bold&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="n">shift</span><span class="o">-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">shift</span><span class="o">+</span><span class="mf">0.08</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">([</span><span class="n">dim</span><span class="p">]))</span>
        <span class="n">set_ticks_for_axis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">feature_names</span><span class="p">[</span><span class="n">dim</span><span class="p">]])</span>

    <span class="c1"># Move the final axis&#39; ticks to the right-hand side</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]))</span>
    <span class="n">set_ticks_for_axis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">feature_names</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">feature_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">ncats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">target_name</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="n">shift</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">shift</span><span class="o">+</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># remove space between subplots</span>

    <span class="k">if</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_fontsize</span>
    <span class="k">return</span> <span class="n">fig</span></div>
</pre></div>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2021, Daniel Rauch (dmrauch).<br/>
    Last updated on August 7, 2022.<br/>
    <div class="extra_footer">
      Built with <a href="https://www.sphinx-doc.org/en/master/index.html">Sphinx</a>
using the <a href="https://sphinx-book-theme.readthedocs.io/en/latest/">Sphinx Book Theme</a>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>