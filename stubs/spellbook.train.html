
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>spellbook.train &#8212; spellbook</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tooltip.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script defer="defer" src="../_static/tooltip.js"></script>
    <script src="../_static/glossary.json"></script>
    <link rel="shortcut icon" href="../_static/spellbook-icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Notes on Tools and Technologies" href="../tools.html" />
    <link rel="prev" title="spellbook.stat" href="spellbook.stat.html" />
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />




  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/spellbook-logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">spellbook</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search" aria-label="Search" autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  The spellbook Library
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../API.html">
   Source Code Reference
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active collapsible-parent">
    <a class="reference internal" href="../API-python.html">
     Python
    </a>
    <ul class="current collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.input.html">
       spellbook.input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.inspect.html">
       spellbook.inspect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.plot.html">
       spellbook.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.plot1D.html">
       spellbook.plot1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.plot2D.html">
       spellbook.plot2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.plotutils.html">
       spellbook.plotutils
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spellbook.stat.html">
       spellbook.stat
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       spellbook.train
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../tools.html">
   Tools and Technologies
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/anaconda.html">
     Anaconda / Conda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/aws.html">
     AWS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/git.html">
     Git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/mkdocs.html">
     MkDocs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/python.html">
     Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/sphinx.html">
     Sphinx
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../tools/tf.html">
     TensorFlow
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../tools/tf-save.html">
       Saving and Loading Models
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/vscode.html">
     Visual Studio Code
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Projects &amp; Tutorials
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../examples/examples.html">
   Table of Contents
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../examples/1-binary-stroke-prediction/index.html">
   Binary Classification: Stroke Prediction
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/1-binary-stroke-prediction/exploration-cleaning.html">
     Data Exploration and Cleaning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/1-binary-stroke-prediction/input-pipeline.html">
     Data Preparation and Input Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../examples/1-binary-stroke-prediction/training-validation.html">
     Model Training and Validation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Extras
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../literature.html">
   Links &amp; Literature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../todo.html">
   ToDo List
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
    <table style="margin-top:2.0rem;">
        <tr>
            <td style="text-align: left;">
                <a href="https://github.com/dmrauch">
                    <img src="../_static/GitHub-Mark-32px.png" height="16" padding-right="1em">
                </a>
            </td>
            <td style="padding-left: 0.5rem; text-align: left; font-style:italic; font-weight: bold;">
                Contact me on <a href="https://github.com/dmrauch">GitHub</a>
            </td>
        </tr>
        <tr>
            <td style="text-align: left;">
                <a href="https://www.linkedin.com/in/dmrauch/">
                    <img src="../_static/LI-In-Bug.png" height="16" padding-right="1em"></td>
                </a>
            <td style="padding-left: 0.5rem; text-align: left; font-style:italic; font-weight: bold;">
                Contact me on <a href="https://www.linkedin.com/in/dmrauch/">LinkedIn</a>
            </td>
        </tr>
    </table>
</div>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/stubs/spellbook.train.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dmrauch/spellbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/dmrauch/spellbook/issues/new?title=Issue%20on%20page%20%2Fstubs/spellbook.train.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/dmrauch/spellbook/edit/master/doc/source/stubs/spellbook.train.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="module-spellbook.train">
<span id="spellbook-train"></span><h1>spellbook.train<a class="headerlink" href="#module-spellbook.train" title="Permalink to this headline">¶</a></h1>
<p>Functions for model training and validation</p>
<p><strong>Classes:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ModelSavingCallback" title="spellbook.train.ModelSavingCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelSavingCallback</span></code></a>([foldername, step])</p></td>
<td><p>Callback that intermittently saves the full model during training</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot" title="spellbook.train.ROCPlot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ROCPlot</span></code></a>()</p></td>
<td><p>Plot containing Receiver Operator Characteristic (ROC) curves and working points (WP)</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.get_binary_labels" title="spellbook.train.get_binary_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_binary_labels</span></code></a>(predictions[, threshold])</p></td>
<td><p>Apply threshold to calculate the labels from the predictions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.plot_calibration_curve" title="spellbook.train.plot_calibration_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_calibration_curve</span></code></a>(labels, predictions)</p></td>
<td><p><div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>write docstring for spellbook.train.plot_calibration_curve</p>
</div>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.plot_history" title="spellbook.train.plot_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_history</span></code></a>(history[, nrows, ncols, …])</p></td>
<td><p>Plot the timeline of training metrics</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.plot_history_binary" title="spellbook.train.plot_history_binary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_history_binary</span></code></a>(history[, name_prefix])</p></td>
<td><p>Convenience function for plotting binary classification metrics</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="spellbook.train.ModelSavingCallback">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">spellbook.train.</span></code><code class="sig-name descname"><span class="pre">ModelSavingCallback</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">foldername</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ModelSavingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ModelSavingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback that intermittently saves the full model during training</p>
<p>The model is saved as a folder intermittently in configurable steps
during training as well as at the end of the training. The foldername
is kept unchanged as training goes on, thus always replacing the
last/old model with the current/new state.</p>
<p><strong>Methods:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ModelSavingCallback.__init__" title="spellbook.train.ModelSavingCallback.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>([foldername, step])</p></td>
<td><p>Callback that intermittently saves the full model during training</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ModelSavingCallback.on_epoch_end" title="spellbook.train.ModelSavingCallback.on_epoch_end"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_epoch_end</span></code></a>(epoch, logs)</p></td>
<td><p>Called at the end of every epoch: Save the model every <em>self.step</em> epochs</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ModelSavingCallback.on_train_end" title="spellbook.train.ModelSavingCallback.on_train_end"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_train_end</span></code></a>(logs)</p></td>
<td><p>Called at the end of the training: Save the model</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="spellbook.train.ModelSavingCallback.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">foldername</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ModelSavingCallback.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ModelSavingCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback that intermittently saves the full model during training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>foldername</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The model is saved as a folder with this name</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The model is saved every <em>step</em> number of epochs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of the callback, which is then to be added to the
<em>callbacks</em> parameter of <code class="xref py py-func docutils literal notranslate"><span class="pre">tensorflow.keras.Model.fit()</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ModelSavingCallback.on_epoch_end">
<code class="sig-name descname"><span class="pre">on_epoch_end</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ModelSavingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ModelSavingCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of every epoch: Save the model every <em>self.step</em>
epochs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the epoch</p></li>
<li><p><strong>logs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Metrics for this training epoch as well as the
validation epoch if validation is performed. Validation result
keys are prefixed with <code class="docutils literal notranslate"><span class="pre">'val_'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ModelSavingCallback.on_train_end">
<code class="sig-name descname"><span class="pre">on_train_end</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ModelSavingCallback.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ModelSavingCallback.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of the training: Save the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>logs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Currently the output of the last call to
<a class="reference internal" href="#spellbook.train.ModelSavingCallback.on_epoch_end" title="spellbook.train.ModelSavingCallback.on_epoch_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_epoch_end()</span></code></a> is passed to this argument for this
method but that may change in the future.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="spellbook.train.ROCPlot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">spellbook.train.</span></code><code class="sig-name descname"><span class="pre">ROCPlot</span></code><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot containing Receiver Operator Characteristic (ROC) curves and working
points (WP)</p>
<a class="reference internal image-reference" href="../_images/roc.png"><img alt="../_images/roc.png" class="align-center" src="../_images/roc.png" style="width: 550px;" /></a>
<p><strong>Methods:</strong></p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.__iadd__" title="spellbook.train.ROCPlot.__iadd__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__iadd__</span></code></a>(other)</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">+=</span></code> operator</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.__init__" title="spellbook.train.ROCPlot.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>()</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.add_curve" title="spellbook.train.ROCPlot.add_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_curve</span></code></a>(name, labels, predictions[, plot_args])</p></td>
<td><p>Add a ROC curve</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.draw_WP" title="spellbook.train.ROCPlot.draw_WP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">draw_WP</span></code></a>(WP[, line, linestyle, linecolor, …])</p></td>
<td><p>Draw one or more working points and indicate their classifier thresholds as well as true positive and false positive rates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.get_WP" title="spellbook.train.ROCPlot.get_WP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_WP</span></code></a>(name[, threshold, FPR, TPR, method])</p></td>
<td><p>Find working point(s) at specified classifier threshold(s), TPR(s) or FPR(s)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.get_legend_labels" title="spellbook.train.ROCPlot.get_legend_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_legend_labels</span></code></a>()</p></td>
<td><p>Get the labels / texts for the ROC curves to be shown in the legend</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.get_legend_lines" title="spellbook.train.ROCPlot.get_legend_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_legend_lines</span></code></a>()</p></td>
<td><p>Get the lines representing the ROC curves to be shown in the legend</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.pickle_load" title="spellbook.train.ROCPlot.pickle_load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pickle_load</span></code></a>([filename])</p></td>
<td><p>Unpickle and load an instance/object from a file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.pickle_save" title="spellbook.train.ROCPlot.pickle_save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pickle_save</span></code></a>([filename])</p></td>
<td><p>Pickle this instance/object and save it to a file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.plot" title="spellbook.train.ROCPlot.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>()</p></td>
<td><p>Plot one or more ROC curves and working points to a figure object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.remove_curve" title="spellbook.train.ROCPlot.remove_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_curve</span></code></a>(name)</p></td>
<td><p>Remove a ROC curve</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#spellbook.train.ROCPlot.rename_curve" title="spellbook.train.ROCPlot.rename_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rename_curve</span></code></a>(old_name, new_name)</p></td>
<td><p>Change the name of a ROC curve</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="spellbook.train.ROCPlot.__iadd__">
<code class="sig-name descname"><span class="pre">__iadd__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.__iadd__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.__iadd__" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">+=</span></code> operator</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#spellbook.train.ROCPlot" title="spellbook.train.ROCPlot"><code class="xref py py-class docutils literal notranslate"><span class="pre">spellbook.train.ROCPlot</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.add_curve">
<code class="sig-name descname"><span class="pre">add_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.add_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.add_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a ROC curve</p>
<p>Internally it uses <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html#sklearn.metrics.roc_auc_score" title="(in scikit-learn v0.24)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.metrics.roc_auc_score()</span></code></a> to calculate
the ROC curve from the true labels and the predictions / classifier
outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the ROC curve</p></li>
<li><p><strong>labels</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>] </em><em>/ numpy.ndarray</em><em>(</em><em>ndim=1</em><em>)</em>) – The target labels for
the datapoints</p></li>
<li><p><strong>predictions</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>] </em><em>/ numpy.ndarray</em><em>(</em><em>ndim=1</em><em>)</em>) – The sigmoid-
activated predictions for the datapoints. Note that not the
predicted labels but rather the sigmoid-activated predictions
should be used so that by scanning different thresholds the
different true positive / false positive rates can be
determined.</p></li>
<li><p><strong>plot_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Arguments to be passed to
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="(in Matplotlib v3.4.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.plot()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.draw_WP">
<code class="sig-name descname"><span class="pre">draw_WP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">WP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.draw_WP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.draw_WP" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw one or more working points and indicate their classifier thresholds
as well as true positive and false positive rates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>WP</strong> (<em>dict /</em><em> [</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>]</em>) – One or more working points as returned by
<a class="reference internal" href="#spellbook.train.ROCPlot.get_WP" title="spellbook.train.ROCPlot.get_WP"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_WP()</span></code></a></p></li>
<li><p><strong>linestyle</strong> (<em>str /</em><em> [</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – Linestyle(s) for drawing the
horizontal and vertical lines designating the working point(s)</p></li>
<li><p><strong>info</strong> (<em>bool /</em><em> [</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – Whether or not the parameters of the
WP(s) should be shown on the graph. If <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">True</span></code>,
then all WPs are included. If <code class="docutils literal notranslate"><span class="pre">False</span></code> or <code class="docutils literal notranslate"><span class="pre">[]</span></code>, none are
given. If a list of integers is given, then the WPs with the
corresponding indices are shown.</p></li>
<li><p><strong>highlight</strong> (<em>bool / int</em><em>, </em><em>optional</em>) – Whether or not and which WP and
its parameters should be highlighted. If a single WP is given,
then highlight should be a bool. If multiple WPs are given, it
should be an integer specifying the index of the WP to
highlight.</p></li>
</ul>
</dd>
</dl>
<p>Some examples of how to calculate and draw working points are given
<a class="reference internal" href="#wp-example"><span class="std std-ref">here</span></a> in <a class="reference internal" href="#spellbook.train.ROCPlot.get_WP" title="spellbook.train.ROCPlot.get_WP"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_WP()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.get_WP">
<code class="sig-name descname"><span class="pre">get_WP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FPR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TPR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interpolate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.get_WP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.get_WP" title="Permalink to this definition">¶</a></dt>
<dd><p>Find working point(s) at specified classifier threshold(s), TPR(s) or
FPR(s)</p>
<p>Either the classifier threshold, the TPR or the FPR parameter can be
specified to determine one or more matching working points (WP), but not
more than one of the three at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of the curve from which to determine the WP(s)</p></li>
<li><p><strong>threshold</strong> (<em>float /</em><em> [</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em>) – Threshold/cut value on the classifier’s
sigmoid-activated output to separate the two classes</p></li>
<li><p><strong>FPR</strong> (<em>float /</em><em> [</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em>) – Target FPR(s) to match</p></li>
<li><p><strong>TPR</strong> (<em>float /</em><em> [</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em>) – Target TPR(s) to match</p></li>
<li><p><strong>method</strong> (<code class="docutils literal notranslate"><span class="pre">interpolate</span></code> / <code class="docutils literal notranslate"><span class="pre">nearest</span></code>) – <p>Method for determining the
working point(s)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">interpolate</span></code>: find the two points that enclose the target
value and interpolate linearly between them</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nearest</span></code>: find the point that is nearest to the target
value</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>threshold</cite>/<cite>FPR</cite>/<cite>TPR</cite> is a scalar, then a dict
containing the matching WP with its threshold, FPR and TPR
is returned. If <cite>threshold</cite>/<cite>FPR</cite>/<cite>TPR</cite> is a list, then a list of
dicts is returned, with each entry in the list corresponding to one
WP.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict / [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a>]</p>
</dd>
</dl>
<p class="rubric" id="wp-example">Example</p>
<ul>
<li><p>Get a single working point by specifying a classifier threshold
and draw it</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ROCPlot</span><span class="p">()</span>
<span class="n">roc</span><span class="o">.</span><span class="n">add_curve</span><span class="p">(</span><span class="s1">&#39;1000 epochs (testing)&#39;</span><span class="p">,</span>
              <span class="n">test_labels</span><span class="p">,</span> <span class="n">test_predictions</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
              <span class="n">plot_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">))</span>
<span class="n">WP</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">get_WP</span><span class="p">(</span><span class="s1">&#39;1000 epochs (testing)&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">roc</span><span class="o">.</span><span class="n">draw_WP</span><span class="p">(</span><span class="n">WP</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">sb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;roc.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Get multiple working points by specifying FPRs and TPRs and draw
them</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ROCPlot</span><span class="p">()</span>
<span class="n">roc</span><span class="o">.</span><span class="n">add_curve</span><span class="p">(</span><span class="s1">&#39;1000 epochs (testing)&#39;</span><span class="p">,</span>
              <span class="n">test_labels</span><span class="p">,</span> <span class="n">test_predictions</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
              <span class="n">plot_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">))</span>
<span class="n">WPs1</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">get_WP</span><span class="p">(</span><span class="s1">&#39;1000 epochs (testing)&#39;</span><span class="p">,</span> <span class="n">FPR</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">WPs2</span> <span class="o">=</span> <span class="n">roc</span><span class="o">.</span><span class="n">get_WP</span><span class="p">(</span><span class="s1">&#39;1000 epochs (testing)&#39;</span><span class="p">,</span> <span class="n">TPR</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">roc</span><span class="o">.</span><span class="n">draw_WP</span><span class="p">(</span><span class="n">WPs1</span><span class="o">+</span><span class="n">WPs2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;black])</span>
<span class="n">sb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">roc</span><span class="o">.</span><span class="n">plot</span><span class="p">(),</span> <span class="s1">&#39;roc.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.get_legend_labels">
<code class="sig-name descname"><span class="pre">get_legend_labels</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.get_legend_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.get_legend_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the labels / texts for the ROC curves to be shown in the legend</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Labels / texts for the ROC curves to be shown in the legend</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.get_legend_lines">
<code class="sig-name descname"><span class="pre">get_legend_lines</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.get_legend_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.get_legend_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lines representing the ROC curves to be shown in the legend</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Lines representing the ROC
curves to be shown in the legend</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>[<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.lines.Line2D.html#matplotlib.lines.Line2D" title="(in Matplotlib v3.4.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.lines.Line2D</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.pickle_load">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">pickle_load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'roc.pickle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.pickle_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpickle and load an instance/object from a file</p>
<p>Based on <a class="reference external" href="https://stackoverflow.com/q/35649603">https://stackoverflow.com/q/35649603</a> and
<a class="reference external" href="https://stackoverflow.com/a/35667484">https://stackoverflow.com/a/35667484</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the file from which the object should be
loaded</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The unpickled instance / object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ROC</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.pickle_save">
<code class="sig-name descname"><span class="pre">pickle_save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'roc.pickle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.pickle_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.pickle_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickle this instance/object and save it to a file</p>
<p>Based on <a class="reference external" href="https://stackoverflow.com/q/35649603">https://stackoverflow.com/q/35649603</a> and
<a class="reference external" href="https://stackoverflow.com/a/35667484">https://stackoverflow.com/a/35667484</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the file to which the object should be
saved</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot one or more ROC curves and working points to a figure object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The figure containing the full
plot including one or more curves and working points</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.remove_curve">
<code class="sig-name descname"><span class="pre">remove_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.remove_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.remove_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a ROC curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The name of the curve to be removed</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="spellbook.train.ROCPlot.rename_curve">
<code class="sig-name descname"><span class="pre">rename_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#ROCPlot.rename_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.ROCPlot.rename_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the name of a ROC curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The old name</p></li>
<li><p><strong>new_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The new name</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="spellbook.train.get_binary_labels">
<code class="sig-prename descclassname"><span class="pre">spellbook.train.</span></code><code class="sig-name descname"><span class="pre">get_binary_labels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#get_binary_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.get_binary_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply threshold to calculate the labels from the predictions</p>
<p>It is necessary to apply the threshold and unequivocally assign each
datapoint to a category for the calculation of the confusion matrix to
work correctly in <em>TensorFlow</em>. When given the sigmoid-activated classifier
output, the confusion matrix calculation will otherwise floor() the
predictions to zero and associate all datapoints with the first/negative
class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.framework.ops.Tensor</span></code>]) – The sigmoid-activated classifier outputs, one value for
each datapoint</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Datapoints whose prediction is below the threshold are
associated to the first/negative class, datapoints whose prediction
is above the threshold to the second/positive class</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Array of predicted labels</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spellbook</span> <span class="k">as</span> <span class="nn">sb</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<span class="go">[0.  0.2 0.4 0.6 0.8]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># default threshold of 0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_binary_labels</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">predicted_labels</span><span class="p">)</span>
<span class="go">[False False False  True  True]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># custom threshold of 0.7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_binary_labels</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">predicted_labels</span><span class="p">)</span>
<span class="go">[False False False False  True]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># type(predictions)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">sb</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_binary_labels</span><span class="p">((</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Argument &#39;predictions&#39; must be of type &#39;numpy.ndarray&#39; or &#39;tensorflow.Tensor&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="spellbook.train.plot_calibration_curve">
<code class="sig-prename descclassname"><span class="pre">spellbook.train.</span></code><code class="sig-name descname"><span class="pre">plot_calibration_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histogram_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#plot_calibration_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.plot_calibration_curve" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>write docstring for spellbook.train.plot_calibration_curve</p>
</div>
<a class="reference internal image-reference" href="../_images/calibration.png"><img alt="../_images/calibration.png" class="align-center" src="../_images/calibration.png" style="width: 400px;" /></a>
</dd></dl>

<dl class="py function">
<dt id="spellbook.train.plot_history">
<code class="sig-prename descclassname"><span class="pre">spellbook.train.</span></code><code class="sig-name descname"><span class="pre">plot_history</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['loss',</span> <span class="pre">'val_loss']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['training</span> <span class="pre">loss',</span> <span class="pre">'validation</span> <span class="pre">loss']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['l',</span> <span class="pre">'l']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[[1.0,</span> <span class="pre">1.0]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['.3f',</span> <span class="pre">'.3f']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['',</span> <span class="pre">'']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['loss']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['accuracy']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['bl']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#plot_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.plot_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the timeline of training metrics</p>
<a class="reference internal image-reference" href="../_images/loss-acc.png"><img alt="../_images/loss-acc.png" class="align-center" src="../_images/loss-acc.png" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> or         <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/History" title="(in TensorFlow v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tf.keras.callbacks.History</span></code></a>) – <em>TensorFlow</em> history object returned by the model training or read
from a <code class="docutils literal notranslate"><span class="pre">*.csv</span></code> file produced with the
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/CSVLogger" title="(in TensorFlow v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tf.keras.callbacks.CSVLogger</span></code></a> callback during training</p></li>
<li><p><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – <em>Optional</em>. Number of rows of plots arranged in a grid</p></li>
<li><p><strong>ncols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – <em>Optional</em>. Number of columns of plots arranged in a grid</p></li>
<li><p><strong>metrics</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – <em>Optional</em>. Names of the metrics in the history
object that should be plotted</p></li>
<li><p><strong>names</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – <em>Optional</em>. How the plotted metrics should be named
in the legends</p></li>
<li><p><strong>axes</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – <em>Optional</em>. <code class="docutils literal notranslate"><span class="pre">l</span></code> or <code class="docutils literal notranslate"><span class="pre">r</span></code> to describe on which y-axis
a particular variable should be drawn</p></li>
<li><p><strong>colors</strong> (<em>str /</em><em> [</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – <em>Optional</em>. The line color(s). Can be either
a single color string, in which case all lines will have this same
color, or a list of lists of strings specifying the line colors for
each metric.</p></li>
<li><p><strong>zorders</strong> (<em>float /</em><em> [</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em><em>]</em>) – <em>Optional</em>. The zorder(s). Can be either
a single float, in which case all zorders will have this same value,
or a list of lists of floats specifying the zorders for each
metric.</p></li>
<li><p><strong>scaling_factors</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em><em>]</em>) – <em>Optional</em>. Scaling factors that multiply
each metric</p></li>
<li><p><strong>formats</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – <em>Optional</em>. Format strings specifying how last value
of each metric should be printed in the legends. Metrics are floats.</p></li>
<li><p><strong>units</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em><em>]</em>) – <em>Optional</em>. Units that should be appended to the
legend entry for each metric</p></li>
<li><p><strong>titles</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em>) – <em>Optional</em>. List containing one title for each plot in
the grid</p></li>
<li><p><strong>y1labels</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em>) – <em>Optional</em>. List containing one label for the left
axes for each plot in the grid</p></li>
<li><p><strong>y2labels</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em>) – <em>Optional</em>. List containing one label for the right
axes for each plot in the grid</p></li>
<li><p><strong>legend_positions</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em>) – <em>Optional</em>. List containing a two-character
string governing the legend position for each plot in the grid.
Possible values are <code class="docutils literal notranslate"><span class="pre">tl</span></code>, <code class="docutils literal notranslate"><span class="pre">tc</span></code>, <code class="docutils literal notranslate"><span class="pre">tr</span></code>, <code class="docutils literal notranslate"><span class="pre">cl</span></code>, <code class="docutils literal notranslate"><span class="pre">cc</span></code>, <code class="docutils literal notranslate"><span class="pre">cr</span></code>,
<code class="docutils literal notranslate"><span class="pre">bl</span></code>, <code class="docutils literal notranslate"><span class="pre">bc</span></code> and <code class="docutils literal notranslate"><span class="pre">br</span></code> as implemented in
<a class="reference internal" href="spellbook.plotutils.html#spellbook.plotutils.legend_loc" title="spellbook.plotutils.legend_loc"><code class="xref py py-func docutils literal notranslate"><span class="pre">spellbook.plotutils.legend_loc()</span></code></a>
and <a class="reference internal" href="spellbook.plotutils.html#spellbook.plotutils.legend_bbox_to_anchor" title="spellbook.plotutils.legend_bbox_to_anchor"><code class="xref py py-func docutils literal notranslate"><span class="pre">spellbook.plotutils.legend_bbox_to_anchor()</span></code></a>.</p></li>
<li><p><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]) – <em>Optional</em>, baseline fontsize for all elements.
This is probably the fontsize that <code class="docutils literal notranslate"><span class="pre">medium</span></code> corresponds to?</p></li>
<li><p><strong>figure_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – <em>Optional</em>, arguments for the creation of the
<a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a> with
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="(in Matplotlib v3.4.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The figure containing the plot or
grid of plots</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spellbook.train.plot_history_binary">
<code class="sig-prename descclassname"><span class="pre">spellbook.train.</span></code><code class="sig-name descname"><span class="pre">plot_history_binary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'history-binary'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spellbook/train.html#plot_history_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spellbook.train.plot_history_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for plotting binary classification metrics</p>
<table class="spellbook-gallery-scroll table">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/loss-acc.png"><img alt="../_images/loss-acc.png" src="../_images/loss-acc.png" style="height: 200px;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/true-false-pos-neg-rates.png"><img alt="../_images/true-false-pos-neg-rates.png" src="../_images/true-false-pos-neg-rates.png" style="height: 200px;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/rec-prec.png"><img alt="../_images/rec-prec.png" src="../_images/rec-prec.png" style="height: 200px;" /></a>
</td>
</tr>
</tbody>
</table>
<p>The following plots are generated:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name_prefix&gt;-loss-acc.png</span></code>: Loss (binary crossentropy) and accuracy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name_prefix&gt;-pos-neg.png</span></code>: Numbers of true/false positives/negatives</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name_prefix&gt;-rec-prec.png</span></code> <a class="reference internal" href="../glossary.html#term-TPR"><span class="xref std std-term">Recall/sensitivity</span></a> and
<a class="reference internal" href="../glossary.html#term-precision"><span class="xref std std-term">precision</span></a></p></li>
</ul>
<p>The metrics are defined as:</p>
<ul class="simple">
<li><p>Recall = Sensitivity = True Positives / (True Positives + False Negatives)</p></li>
<li><p>Precision = True Positives / (True Positives + False Positives)</p></li>
</ul>
<p>In the plot containing the true/false positives/negatives, the left/primary
and right/secondary y-axes are scaled relative to each other according to
the ratio of the sizes of the training and validation datasets. Therefore,
for a correctly working model and in the absence of significant
overtraining, the training and validation curves should lie more or less
on top of each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> or         <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/History" title="(in TensorFlow v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tf.keras.callbacks.History</span></code></a>) – <em>TensorFlow</em> history object returned by the model training or read
from a <code class="docutils literal notranslate"><span class="pre">*.csv</span></code> file produced with the
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/CSVLogger" title="(in TensorFlow v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tf.keras.callbacks.CSVLogger</span></code></a> callback during training</p></li>
<li><p><strong>name_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Prefix to the filenames of the plots</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="spellbook.stat.html" title="previous page">spellbook.stat</a>
    <a class='right-next' id="next-link" href="../tools.html" title="next page">Notes on Tools and Technologies</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2021, Daniel Rauch (dmrauch).<br/>
          Last updated on June 13, 2021.<br/>
          <div class="extra_footer">
            Built with <a href="https://www.sphinx-doc.org/en/master/index.html">Sphinx</a>
using the <a href="https://sphinx-book-theme.readthedocs.io/en/latest/">Sphinx Book Theme</a>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>